<div class="inner">
	<div class="input">
		<textarea name="" id="" placeholder="접수된 민원내역을 입력해주세요."></textarea>
	</div>
	<div class="command">
		<div class="attach">
			<input type="file" id="file-attach-input" style="display: none;" multiple>
			<div class="custom-select added" data-value="">
				<div class="custom-select-button">추가하기</div>
				<div class="custom-select-dropdown">
					<div class="custom-select-option" data-action="file">
						파일추가
					</div>
					<div class="custom-select-option" data-action="xx1">
						XX추가
					</div>
					<div class="custom-select-option" data-action="xx2">
						XX추가
					</div>
				</div>
			</div>
		</div>

		<div class="cta">
			<div class="custom-select" data-value="">
				<div class="custom-select-button">
					<span class="custom-select-text">기본 상담</span>
				</div>
				<div class="custom-select-dropdown">
					<div class="custom-select-option selected" data-value="">기본 상담
					</div>
					<div class="custom-select-option" data-value="option2">option2</div>
					<div class="custom-select-option" data-value="option3">option3</div>
				</div>
			</div>
			<div class="custom-select" data-value="">
				<div class="custom-select-button">
					<span class="custom-select-text">Auto</span>
				</div>
				<div class="custom-select-dropdown">
					<div class="custom-select-option selected" data-value="">Auto
					</div>
					<div class="custom-select-option" data-value="option2">option2</div>
					<div class="custom-select-option" data-value="option3">option3</div>
				</div>
			</div>
			<a href="#" class="send">입력</a>
		</div>
	</div>
	<div class="options">
		<div>
			<div class="set-option">
				<label class="switch">
					<input type="checkbox" id="switch">
					<span class="slider"></span>
				</label>
				<div class="labelname">근거 우선</div>
			</div>
		</div>

		<div>
			<div class="custom-select min" data-value="">
				<div class="custom-select-button">
					<span class="custom-select-text">업무형 톤(정확/간결)</span>
				</div>
				<div class="custom-select-dropdown">
					<div class="custom-select-option selected" data-value="">업무형 톤(정확/간결)
					</div>
					<div class="custom-select-option" data-value="option2">option2</div>
					<div class="custom-select-option" data-value="option3">option3</div>
				</div>
			</div>

			<div class="custom-select min" data-value="">
				<div class="custom-select-button">
					<span class="custom-select-text">보통 길이</span>
				</div>
				<div class="custom-select-dropdown">
					<div class="custom-select-option selected" data-value="">보통 길이
					</div>
					<div class="custom-select-option" data-value="option2">option2</div>
					<div class="custom-select-option" data-value="option3">option3</div>
				</div>
			</div>

			<div class="custom-select min" data-value="">
				<div class="custom-select-button">
					<span class="custom-select-text">목록/단락 위주</span>
				</div>
				<div class="custom-select-dropdown">
					<div class="custom-select-option selected" data-value="">목록/단락 위주
					</div>
					<div class="custom-select-option" data-value="option2">option2</div>
					<div class="custom-select-option" data-value="option3">option3</div>
				</div>
			</div>
		</div>
	</div>
</div>
<script>
	(function () {
		'use strict';

		// user-global-chat 초기화
		function initUserGlobalChat() {
			const $chatContainer = $('.user-global-chat');
			if (!$chatContainer.length) return;

			initAddedTypeSelect($chatContainer);
			initTextarea($chatContainer);
			initFileAttach($chatContainer);
		}

		// added 타입 select 초기화 (user-global-chat 전용)
		function initAddedTypeSelect($container) {
			$container.find('.custom-select.added').each(function () {
				const $customSelect = $(this);
				const $button = $customSelect.find('.custom-select-button');
				const $dropdown = $customSelect.find('.custom-select-dropdown');

				// 버튼 클릭 시 드롭다운 토글
				$button.on('click', function (e) {
					e.preventDefault();
					e.stopPropagation();

					// 다른 커스텀 select 닫기
					$('.custom-select').not($customSelect).removeClass('open');
					$('.custom-select-dropdown').not($dropdown).removeClass('open');

					// 현재 select 토글
					$customSelect.toggleClass('open');
					$dropdown.toggleClass('open');
				});

				// 옵션 클릭 시 액션 실행
				$dropdown.find('.custom-select-option').on('click', function (e) {
					e.preventDefault();
					e.stopPropagation();

					const action = $(this).data('action');
					handleAddedTypeAction(action);

					// 드롭다운 닫기
					$customSelect.removeClass('open');
					$dropdown.removeClass('open');
				});

				// 외부 클릭 시 닫기
				$(document).on('click.custom-select-added-' + $customSelect.index(), function (e) {
					if (!$customSelect.is(e.target) && !$customSelect.has(e.target).length) {
						$customSelect.removeClass('open');
						$dropdown.removeClass('open');
					}
				});
			});
		}

		// added 타입 액션 처리
		function handleAddedTypeAction(action) {
			switch (action) {
				case 'file':
					$('#file-attach-input').trigger('click');
					break;
				case 'xx1':
					console.log('XX추가 1 실행');
					// 여기에 XX추가 1 기능 구현
					break;
				case 'xx2':
					console.log('XX추가 2 실행');
					// 여기에 XX추가 2 기능 구현
					break;
			}
		}

		// textarea 입력 처리
		function initTextarea($container) {
			$container.find('textarea').on('input', function () {
				const val = $(this).val().trim();
				const $sendBtn = $container.find('.command .send');

				if (val.length > 0) {
					$sendBtn.addClass('active');
				} else {
					$sendBtn.removeClass('active');
				}
			});
		}

		// 파일 첨부 처리
		function initFileAttach($container) {
			$('#file-attach-input').on('change', function (e) {
				const files = e.target.files;
				if (files && files.length > 0) {
					console.log('선택된 파일:', files);
					// 여기에 파일 목록 표시 또는 업로드 처리 로직 추가
					// 예: 파일 목록을 화면에 표시하거나 서버로 업로드
				}
			});
		}

		// 초기화 실행
		$(document).ready(function () {
			initUserGlobalChat();
		});
	})();
</script>