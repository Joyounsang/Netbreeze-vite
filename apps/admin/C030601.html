<!DOCTYPE html>
<html lang="ko" class="white">
<include src="src/includes/head.html"></include>

<body>
	<div class="viewport">
		<include src="src/includes/GNB.html"></include>
		<div class="container">
			<include src="src/includes/header.html"></include>

			<div class="contents">
				<div class="panel">
					<div class="row">
						<div class="column">
							<article>
								<include src="src/includes/PageHead.html"></include>
								<div class="query">
									<div class="input-item">
										<div class="input-item-inner">
											<p>질문별 선거인단의 답변을 확인하실 수 있습니다.</p>
										</div>
									</div>
								</div>
							</article>
						</div>
					</div>


					<div class="row">

						<div class="column">
							<div class="content-header">
								<div class="title lv2">입주민 회장</div>
								<div class="flex"><a href="#" class="btn medium normal line">재발송 하기</a></div>
							</div>
							<article>
								<div class="realtimeChart">
									<div class="chart-area">
										<div class="chart-group doughnut">
											<div class="chart-item">
												<div class="doughnut-value">
													<span class="unit">실시간<br>
														참여율</span>
												</div>
												<canvas id="doughnutChart1"></canvas>
											</div>
										</div>
									</div>
								</div>
							</article>

						</div>
						<div class="column">
							<div class="voteItem type-result">
								<ul>
									<li class="progress on">
										<div class="bar" data-max-value="100" data-value="30"></div>
										<div class="inner">
											<div class="tit">101동</div>
											<div class="val">30%(42명)</div>
										</div>
									</li>
									<li class="progress">
										<div class="bar" data-max-value="100" data-value="60"></div>
										<div class="inner">
											<div class="tit">102동</div>
											<div class="val">60%(42명)</div>
										</div>
									</li>
									<li class="progress">
										<div class="bar" data-max-value="100" data-value="10"></div>
										<div class="inner">
											<div class="tit">103동</div>
											<div class="val">10%(42명)</div>
										</div>
									</li>

									<li class="progress dual">
										<div class="inner">
											<div class="tit">102동</div>
											<div class="dual-data">
												<div class="dual-val left">70% 70표</div>
												<div class="bar" data-max-value="100" data-value="70"></div>
												<div class="bar" data-max-value="100" data-value="30"></div>
												<div class="dual-val right">30% 30표</div>
											</div>
											<div class="val">60%(42명)</div>
										</div>
									</li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>


	<script>
		let charts = {};
		document.addEventListener("DOMContentLoaded", function () {

			// 공통 색상 정의
			const COLORS = {
				primary: '#5680eb',    // 파란색
				secondary: '#FD6465',  // 빨강색
				tertiary: '#51A39E',   // 민트색
				background: '#D9DAE1', // 회색
				grid: '#F5F5F9',      // 그리드 색상
				text: '#9FA2B4'       // 텍스트 색상
			};

			// 파이 차트 생성
			const createDoughnutChart = (chartId, data, colors) => {
				const ctx = document.getElementById(chartId);
				return new Chart(ctx, {
					type: 'pie',
					data: {
						labels: false,
						datasets: [{
							data: data,
							backgroundColor: colors,
							hoverBackgroundColor: colors,
							borderWidth: 0
						}]
					},
					options: {
						aspectRatio: 1,
						responsive: true,
						maintainAspectRatio: true,
						layout: { padding: 0 },
						animation: {
							duration: 800,
							easing: 'easeOutQuad'
						},
						cutoutPercentage: 50
					},

				});
			};



			function createCharts() {
				// 레이아웃 유연성을 위한 기존차트제거
				Object.values(charts).forEach(chart => chart.destroy());

				// 애니메이션을 위한 새차트 생성 및 데이터 
				charts.doughnutChart1 = createDoughnutChart("doughnutChart1", [50, 50, 10], [COLORS.primary, COLORS.secondary, COLORS.background]);

				const { labels, data } = (() => {
					const today = new Date();
					const labels = Array.from({ length: 5 }, (_, i) => {
						const date = new Date(today);
						date.setDate(date.getDate() - (4 - i));
						return `2/${date.getDate()}`;
					});
					return { labels, data: [50, 40, 10] };
				})();

			}

			createCharts();  // 차트 생성

			let resizeTimer;
			window.addEventListener("resize", function () {
				clearTimeout(resizeTimer);
				resizeTimer = setTimeout(() => {
					createCharts(); // 브라우저 리사이즈시에도 차트 재생성
				}, 100);
			});
		});

	</script>

</body>

</html>